<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Expense and Budget Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
/* Reset & base */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{
  background:#d9f7f2;           /* Mint background */
  color:#033b4a;                /* Deep teal-blue text */
  line-height:1.6;font-size:16px;
}
main{max-width:900px;margin:0 auto;padding:10px;}

/* Smooth jump */
section{padding:40px 15px;transition:transform 0.4s ease;scroll-margin-top:80px;}

/* Navigation */
nav{
  display:flex;justify-content:space-between;align-items:center;
  padding:15px 20px;
  background:linear-gradient(90deg,#0077b6,#00b4d8); /* Blue gradient */
  color:#e2fffb; 
  position:sticky;top:0;z-index:1000;
  box-shadow:0 4px 12px rgba(0,0,0,0.15);
  border-radius:0 0 15px 15px;
}
nav h2{font-size:1.5em;color:#e2fffb;}
nav ul{display:flex;list-style:none;gap:12px;transition:max-height 0.3s;}
nav ul li a{
  color:#e2fffb;text-decoration:none;padding:10px 15px;
  border-radius:12px;transition:0.3s;font-weight:500;
}
nav ul li a.active,nav ul li a:hover{
  background:#a9fff7; color:#00445f;   /* Mint hover */
}
.hamburger{display:none;flex-direction:column;cursor:pointer;position:absolute;top:18px;right:20px;z-index:1100;}
.hamburger div{width:28px;height:3px;background:#e2fffb;margin:4px 0;transition:0.3s;}

/* Cards */
.card{
  background:#ffffff;padding:20px;margin:15px 0;border-radius:18px;
  box-shadow:0 6px 20px rgba(0,0,0,0.08);
  transition:transform 0.3s;
}
.card:hover{transform:translateY(-4px);}

/* Forms */
form input,form select,form button{
  display:block;width:100%;margin:12px 0;padding:14px;
  border-radius:12px;border:1px solid #b0e3dc;font-size:1em;
}
form button{
  background:#0077b6; color:#e2fffb;
  font-weight:bold;cursor:pointer;transition:0.3s;
}
form button:hover{background:#00b4d8;}

/* Lists */
#expense-list li,#recent-expenses li{
  display:flex;justify-content:space-between;align-items:center;
  background:#eafffa;padding:12px;margin:8px 0;
  border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.05);flex-wrap:wrap;
}
.delete-btn{
  background:#ff6b6b;color:white;border:none;
  padding:6px 12px;border-radius:10px;cursor:pointer;
}
.delete-btn:hover{background:#d90429;}

/* Charts */
.chart-container{
  background:#eafffa;padding:20px;
  border-radius:18px;margin:15px 0;
  box-shadow:0 6px 20px rgba(0,0,0,0.08);
}
canvas{max-width:100%;height:300px!important;}

/* Badges */
.badge{
  display:inline-block;background:#a9fff7;
  color:#00445f;padding:6px 12px;border-radius:16px;
  margin:5px;font-weight:600;
}

/* Progress bars */
.progress-bar{
  background:#bee9e4;border-radius:16px;
  overflow:hidden;height:24px;margin:10px 0;
}
.progress{
  background:#0077b6;height:100%;width:0%;transition:0.5s;
}

/* Confetti */
.confetti{
  position:fixed;width:12px;height:12px;z-index:999;
  animation:fall 3s linear forwards;
}
@keyframes fall{0%{top:-10px}100%{top:100vh;transform:rotate(720deg);}}

/* Responsive */
@media(max-width:768px){
  nav ul{
    flex-direction:column;max-height:0;overflow:hidden;width:90%;
    background:#00b4d8;border-radius:12px;
    position:absolute;top:60px;right:5%;
    box-shadow:0 4px 12px rgba(0,0,0,0.15);
  }
  nav ul.show{max-height:400px;}
  .hamburger{display:flex;}
  main{padding:10px;}
  form input,form select,form button{padding:12px;}
}
</style>
</head>
<body>

<!-- NAVIGATION (unchanged) -->
<nav>
  <h2 style="font-family:'Times New Roman'">Expense And Budget Tracker</h2>
  <div class="hamburger" onclick="toggleMenu()"><div></div><div></div><div></div></div>
  <ul id="nav-links">
    <li><a onclick="jumpTo('dashboard')">Dashboard</a></li>
    <li><a onclick="jumpTo('add-expense')">Add Expense</a></li>
    <li><a onclick="jumpTo('reports')">Reports</a></li>
    <li><a onclick="jumpTo('emotions')">Emotions</a></li>
    <li><a onclick="jumpTo('settings')">Settings</a></li>
  </ul>
</nav>

<main>
<section id="dashboard">
  <h3>Dashboard</h3>
  <div class="card"><b>Total Budget:</b> â‚¹<span id="total-budget">0</span></div>
  <div class="card"><b>Total Expense:</b> â‚¹<span id="total-expense">0</span></div>
  <div class="card"><b>Remaining:</b> â‚¹<span id="remaining-budget">0</span></div>
  <div class="card">
    <b>Goal Progress:</b>
    <div class="progress-bar"><div id="goal-progress-bar" class="progress"></div></div>
    <span id="goal-progress-text"></span>
  </div>
  <div class="card">
    <b>Level & XP:</b>
    <div class="progress-bar"><div id="xp-progress" class="progress"></div></div>
    Level <span id="level">1</span> | XP <span id="xp">0</span>
  </div>
  <div class="card"><b>Streak:</b> <span id="streak">0 days</span></div>
  <h4>Recent Expenses</h4>
  <ul id="recent-expenses"></ul>
  <div id="badges"></div>
</section>

<section id="add-expense">
  <h3>Add Expense</h3>
  <form id="expense-form">
    <input id="expName" placeholder="Name" required>
    <input id="amount" type="number" placeholder="Amount (â‚¹)" required>
    <input id="date" type="date" required>
    <select id="category" required>
      <option value="">Category</option>
      <option>Food</option>
      <option>Transport</option>
      <option>Shopping</option>
      <option>Trading</option>
      <option>Room Rent</option>
      <option>Personal Need</option>
      <option>Others</option>
    </select>
    <select id="emotion" required>
      <option value="">Emotion</option>
      <option>ðŸ˜Š Happy</option>
      <option>ðŸ˜¢ Sad</option>
      <option>ðŸ˜« Stressed</option>
      <option>ðŸ¤© Excited</option>
      <option>ðŸ˜‚ Laugh</option>
      <option>ðŸ˜‹ Delicious</option>
    </select>
    <button type="submit">Add Expense</button>
  </form>
  <input type="text" id="search-expense" placeholder="Search...">
  <ul id="expense-list"></ul>
</section>

<section id="reports">
  <h3>Reports</h3>
  <div class="chart-container"><canvas id="categoryChart"></canvas></div>
  <div class="chart-container"><canvas id="monthlyChart"></canvas></div>
  <div class="chart-container"><canvas id="emotionChart"></canvas></div>
</section>

<section id="emotions">
  <h3>Emotion Analysis</h3>
  <p id="emotion-insight">Add expenses to see insights.</p>
</section>

<section id="settings">
  <h3>Settings</h3>
  <form id="budget-form">
    <input type="number" id="new-budget" placeholder="Set Budget (â‚¹)">
    <input type="number" id="goal-amount" placeholder="Set Goal (â‚¹)">
    <button type="submit">Save</button>
  </form>
  <button id="export-btn">Export CSV</button>
  <button id="reset-btn">Reset Data</button>
</section>

</main>

<script>
let expenses=JSON.parse(localStorage.getItem('expenses'))||[];
let totalBudget=parseFloat(localStorage.getItem('budget'))||50000;
let goalAmount=parseFloat(localStorage.getItem('goalAmount'))||10000;
let streakDays=parseInt(localStorage.getItem('streakDays'))||0;
let lastDate=localStorage.getItem('lastDate')||null;
let xp=parseInt(localStorage.getItem('xp'))||0;
let level=parseInt(localStorage.getItem('level'))||1;
let badges=JSON.parse(localStorage.getItem('badges'))||[];
let categoryChart,monthlyChart,emotionChart;

function toggleMenu(){document.getElementById('nav-links').classList.toggle('show');}
function jumpTo(id){
  const section=document.getElementById(id);
  section.scrollIntoView({behavior:'smooth'});
  section.style.transform='translateY(-10px)';
  setTimeout(()=>section.style.transform='translateY(0)',300);
  document.querySelectorAll('nav ul li a').forEach(a=>a.classList.remove('active'));
  document.querySelector(`nav ul li a[onclick="jumpTo('${id}')"]`).classList.add('active');
  if(id==='dashboard') updateDashboard();
  if(id==='reports') updateCharts();
  if(id==='emotions') updateEmotionAnalysis();
  if(window.innerWidth<768) toggleMenu();
}

document.getElementById('expense-form').addEventListener('submit',e=>{
  e.preventDefault();

  const nameInput=document.getElementById('expName');
  const amountInput=document.getElementById('amount');
  const dateInput=document.getElementById('date');
  const categoryInput=document.getElementById('category');
  const emotionInput=document.getElementById('emotion');

  if(!nameInput.value||!amountInput.value||!dateInput.value||!categoryInput.value||!emotionInput.value){
    alert("Please fill all fields before adding an expense!");
    return;
  }

  const exp={
    name:nameInput.value.trim(),
    amount:parseFloat(amountInput.value),
    date:dateInput.value,
    category:categoryInput.value,
    emotion:emotionInput.value
  };

  expenses.push(exp);
  addXP(10);
  saveData();
  renderExpenses();
  updateDashboard();
  updateCharts();
  updateEmotionAnalysis();
  e.target.reset();
});

function renderExpenses(){
  let list=document.getElementById('expense-list'); list.innerHTML='';
  let recent=document.getElementById('recent-expenses'); recent.innerHTML='';
  expenses.slice().reverse().forEach((e,i)=>{
    let li=document.createElement('li');
    li.innerHTML=`${e.date} | ${e.name} | â‚¹${e.amount} | ${e.category} | ${e.emotion}`;
    let btn=document.createElement('button');
    btn.textContent='Delete'; btn.className='delete-btn';
    btn.onclick=()=>{expenses.splice(expenses.indexOf(e),1);saveData();renderExpenses();updateDashboard();updateCharts();updateEmotionAnalysis();};
    li.appendChild(btn); list.appendChild(li);
    if(i<5){let li2=document.createElement('li');li2.textContent=li.textContent;recent.appendChild(li2);}
  });
}
document.getElementById('search-expense').addEventListener('input',e=>{
  let q=e.target.value.toLowerCase();
  document.querySelectorAll('#expense-list li').forEach(li=>li.style.display=li.textContent.toLowerCase().includes(q)?'flex':'none');
});

function updateDashboard(){
  let total=expenses.reduce((a,b)=>a+b.amount,0);
  document.getElementById('total-budget').textContent=totalBudget;
  document.getElementById('total-expense').textContent=total;
  document.getElementById('remaining-budget').textContent=totalBudget-total;
  let progress=Math.min((total/goalAmount)*100,100);
  document.getElementById('goal-progress-bar').style.width=progress+'%';
  document.getElementById('goal-progress-text').textContent=`â‚¹${total} / â‚¹${goalAmount}`;
  let today=new Date().toISOString().split('T')[0];
  if(lastDate===today){} else if(lastDate===new Date(Date.now()-86400000).toISOString().split('T')[0]){streakDays++;awardBadge('Streak Master');} else{streakDays=1;}
  lastDate=today; document.getElementById('streak').textContent=streakDays+' days';
  document.getElementById('xp').textContent=xp; document.getElementById('level').textContent=level;
  document.getElementById('xp-progress').style.width=Math.min((xp/(level*50))*100,100)+'%';
  checkGoal(total); displayBadges(); saveData();
}

function updateCharts(){
  let ctx1=document.getElementById('categoryChart').getContext('2d');
  let ctx2=document.getElementById('monthlyChart').getContext('2d');
  let ctx3=document.getElementById('emotionChart').getContext('2d');
  if(categoryChart) categoryChart.destroy();
  if(monthlyChart) monthlyChart.destroy();
  if(emotionChart) emotionChart.destroy();
  let catMap={},monthMap={},emoMap={};
  expenses.forEach(e=>{catMap[e.category]=(catMap[e.category]||0)+e.amount;monthMap[e.date.substring(0,7)]=(monthMap[e.date.substring(0,7)]||0)+e.amount;emoMap[e.emotion]=(emoMap[e.emotion]||0)+1;});
  categoryChart=new Chart(ctx1,{type:'pie',data:{labels:Object.keys(catMap),datasets:[{data:Object.values(catMap),backgroundColor:['#a5d8ff','#c4f1f9','#b5ead7','#d6c6f5']}]}});  
  monthlyChart=new Chart(ctx2,{type:'bar',data:{labels:Object.keys(monthMap),datasets:[{data:Object.values(monthMap),backgroundColor:'#c4f1f9'}]}});  
  emotionChart=new Chart(ctx3,{type:'doughnut',data:{labels:Object.keys(emoMap),datasets:[{data:Object.values(emoMap),backgroundColor:['#a5d8ff','#c4f1f9','#b5ead7','#d6c6f5','#d1d5db']}]}});  
}

function updateEmotionAnalysis(){
  let emoSpend={}; expenses.forEach(e=>{emoSpend[e.emotion]=(emoSpend[e.emotion]||0)+e.amount;});
  let top=Object.entries(emoSpend).sort((a,b)=>b[1]-a[1])[0];
  document.getElementById('emotion-insight').textContent=top?`You spend the most when feeling ${top[0]}`:'Add expenses to see insights.';
}

document.getElementById('budget-form').addEventListener('submit',e=>{
  e.preventDefault();
  totalBudget=parseFloat(document.getElementById('new-budget').value)||totalBudget;
  goalAmount=parseFloat(document.getElementById('goal-amount').value)||goalAmount;
  saveData(); updateDashboard(); e.target.reset();
});
document.getElementById('export-btn').addEventListener('click',()=>{
  let csv='Date,Name,Amount,Category,Emotion\n';
  expenses.forEach(e=>{csv+=`${e.date},${e.name},${e.amount},${e.category},${e.emotion}\n`;});
  let blob=new Blob([csv],{type:'text/csv'}); let a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='expenses.csv'; a.click();
});
document.getElementById('reset-btn').addEventListener('click',()=>{
  if(confirm('Reset all data?')){
    expenses=[]; totalBudget=50000; goalAmount=10000; streakDays=0; lastDate=null; xp=0; level=1; badges=[];
    saveData(); renderExpenses(); updateDashboard(); updateCharts(); updateEmotionAnalysis();
  }
});

function saveData(){
  localStorage.setItem('expenses',JSON.stringify(expenses));
  localStorage.setItem('budget',totalBudget);
  localStorage.setItem('goalAmount',goalAmount);
  localStorage.setItem('streakDays',streakDays);
  localStorage.setItem('lastDate',lastDate);
  localStorage.setItem('xp',xp);
  localStorage.setItem('level',level);
  localStorage.setItem('badges',JSON.stringify(badges));
}

function addXP(amount){xp+=amount;while(xp>=level*50){xp-=level*50;level++;awardBadge('Level Up');showConfetti();}updateDashboard();}
function awardBadge(name){if(!badges.includes(name)){badges.push(name);showConfetti();}}
function displayBadges(){let container=document.getElementById('badges'); container.innerHTML=''; badges.forEach(b=>{let span=document.createElement('span');span.className='badge';span.textContent=b;container.appendChild(span);});}
function showConfetti(){for(let i=0;i<50;i++){let div=document.createElement('div');div.className='confetti';div.style.backgroundColor=`hsl(${Math.random()*360},70%,70%)`;div.style.left=Math.random()*window.innerWidth+'px';div.style.animationDuration=2+Math.random()*2+'s';document.body.appendChild(div);setTimeout(()=>div.remove(),3000);}}
function checkGoal(total){if(total>=goalAmount){awardBadge('Goal Achiever');}}

renderExpenses(); updateDashboard(); updateCharts(); updateEmotionAnalysis(); displayBadges();
</script>
</body>
</html>
